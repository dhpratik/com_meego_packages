            <div tal:condition="not: current_component/packages" i18n:translate="'no_such_application'"></div>

            <div tal:condition="true: current_component/packages" class="app_page" tal:define="packagetitle current_component/packagetitle; package com_meego_packages/packages/$packagetitle">
                <div class="app_page_left">
                    <span class="staging_warning" tal:condition="true: staging_area" i18n:translate="'title_staging_application'">Staging Application</span>

                    <div class="screenshot missing" tal:condition="not: package/screenshoturl"></div>
                    <div class="app_image">
                        <img tal:condition="true: package/screenshoturl" tal:attributes="src package/screenshoturl"/>
                        <img tal:condition="not: package/screenshoturl" src="/midgardmvc-static/com_meego_packages/images/app_image.png"/>
                    </div>
                    <div class="app_download">
                        <a tal:condition="true: package/defaultdownloadurl" tal:attributes="href package/defaultdownloadurl">
                            <img src="/midgardmvc-static/com_meego_packages/images/download.png"/>
                        </a>
                    </div>
                    <div class="app_notes">
                        <ul class="basic_info">
                            <li i18n:translate="'label_app_version'"><tal:block i18n:name="version">x.y</tal:block></li>
                            <li i18n:translate="'label_app_release'"><tal:block i18n:name="date">xxxx-xx-xx</tal:block></li>
                            <li i18n:translate="'label_app_size'"><tal:block i18n:name="size">xxx</tal:block></li>
                        </ul>

                        <div class="homepage" tal:condition="true: package/homepageurl">
                            <a class="url" tal:attributes="href package/homepageurl" i18n:translate="'label_application_homepage'">Homepage</a>
                        </div>

                        <div class="variants" tal:condition="true: package/latest/variants">
                            <span i18n:translate="'title_available_arch_variants'"></span>:
                            <ul>
                                <li tal:repeat="variant package/latest/variants">
                                    <div class="variant">
                                        <a tal:attributes="href variant/packageinstallfileurl; class php: variant.ux . ' ' . variant.repoarch" i18n:domain="com_meego_packages" i18n:attributes="title tip_install" i18n:translate="'command_install'">
                                            <tal:block i18n:name="arch">${variant/repoarch}</tal:block>
                                        </a>
                                    </div>
                                </li>
                            </ul>
                        </div>

                        <div tal:condition="true: package/workflows">
                            <span i18n:translate="'title_open_workflows'"></span>:
                            <div class="workflow_bar">
                                <form tal:repeat="workflow package/workflows" method="post" tal:attributes="action workflow/url">
                                    <input type="submit" tal:attributes="value workflow/label; class workflow/css" />
                                </form>
                             </div>
                        </div>
                    </div>
                </div>
                <div class="app_page_right">
                    <div class="app_title">${package/name}</div>
                    <div class="app_category">${package/basecategoryname}</div>
                    <div class="app_poll">
                        <a tal:condition="true: current_component/can_post" href="#popup_comment" onclick="popup_comment()">
                            <span class="stars" tal:content="structure package/stars">Stars</span>
                        </a>
                        <a tal:condition="not: current_component/can_post" tal:define="main_url php:midgardmvc.context.get_request(0).get_path(); url string:/mgd:login?redirect=$main_url" tal:attributes="href url">
                            <span class="stars" tal:content="structure package/stars">Stars</span>
                        </a>
                    </div>
                    <div class="app_content">${package/description}</div>
                    <div tal:condition="not: current_component/can_post" class="app_login_write">
                        <a tal:define="main_url php:midgardmvc.context.get_request(0).get_path(); url string:/mgd:login?redirect=$main_url" tal:attributes="href url" i18n:translate="'command_login_to_comment'"/>
                    </div>

                    <div class="app_slider"><img src="/midgardmvc-static/com_meego_packages/images/slider.jpg" /></div>
                </div>
                <div class="clear"></div>
                <div class="app_comment">
                    <div class="app_comment_title">
                        <div class="app_h2" i18n:translate="'label_user_comments'">User comments</div>
                        <div tal:condition="true: current_component/can_post" class="app_comment_write">
                            <a href="#popup_comment" onclick="popup_comment()"><img src="/midgardmvc-static/com_meego_packages/images/writecomment.jpg" /></a>
                        </div>
                        <div tal:condition="not: current_component/can_post" class="app_login_write">
                            <a tal:define="main_url php:midgardmvc.context.get_request(0).get_path(); url string:/mgd:login?redirect=$main_url" tal:attributes="href url" i18n:translate="'command_login_to_comment'"/>
                        </div>
                    </div>

                    <div class="app_forms" tal:condition="true: staging_area">
                        <div class="app_h2" i18n:translate="'label_user_tests'">User Tests</div>
                        <div class="forms" tal:content="structure php:midgardmvc.templating.dynamic_load('com_meego_packages', 'package_posted_forms', array('package' => com_meego_packages['packages'][com_meego_packages['packagetitle']]['packageguid']))"></div>
                    </div>

                    <div class="clear"></div>

                    <div class="app_comment_main" tal:condition="true: package/ratings">
                        <div class="app_comment_block" tal:repeat="rating package/ratings">
                            <div class="app_comment_block_user">
                                <div class="app_comment_block_pic">
                                    <a tal:condition="true: rating/avatar" tal:attributes="href rating/avatarurl">
                                        <img tal:attributes="src rating/avatar" />
                                    </a>
                                    <img tal:condition="not: rating/avatar" src="/midgardmvc-static/com_meego_packages/images/no_image.jpg" />
                                </div>
                                <div class="app_comment_block_more">
                                    <div class="app_comment_name">${rating/authorfirstname} ${rating/authorlastname}</div>
                                    <div class="app_comment_date">${rating/date}</div>
                                    <div class="app_comment_poll">
                                        <div tal:condition="rating/stars" tal:content="structure rating/stars">Stars</div>
                                    </div>
                                </div>
                            </div>
                            <div class="app_comment_block_comment">${rating/comment}</div>
                            <div class="clear"></div>
                        </div>

                        <div class="app_comment_write">
                            <a href="#popup_comment" onclick="popup_comment()"><img src="/midgardmvc-static/com_meego_packages/images/writecomment.jpg" /></a>
                        </div>
                    </div>
                </div>

                <mgd:include>cmp-popup-rate-comment-application</mgd:include>

            </div>

